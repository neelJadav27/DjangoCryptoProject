{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Home Page</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
{% include 'header.html' %}
    <form action="{% url 'crypto:cryptoName' cryptoName%}" method="POST">

        {% csrf_token %}
        <input name="oneDay"  value="1 Day" type="submit"/>
        <input name="sevenDays" value="7 days" type="submit" />
        <input name="fifteenDays" value="15 days" type="submit" />
        <input name="oneMonth" value="1 month" type="submit" />
        <input name="twoMonths"  value="2 month" type="submit"/>


    <div style="height: 150px; width: 300px;">

      <canvas style="background: azure" id="myChart{{ cryptoName }}"></canvas>
    </div>

<script>
      var labelName = "labels";
      var dataName = "data";
      var configName = "config";
      var myChartName = "myChart";

      window[labelName] = [
                    {% for row in rows %}
                            {% if row.currency == cryptoName %}
                                    '{{ " "     }}',
                            {% endif %}
                      {% endfor %}
                    ];

      window[dataName] = {
        labels: window[labelName],
        datasets: [{
          label: 'My First dataset',
          backgroundColor: 'rgb(255, 99, 132)',
          borderColor: 'rgb(255, 99, 132)',
        pointRadius:1,
          data:
              [{% for row in rows %}
                  {% if row.currency == cryptoName %}
                    {{ row.High }},
                  {% endif %}
              {% endfor %}]
        }]
      };

      window[configName] = {
        type: 'line',
        data: window[dataName],

        options: {
            plugins: {
            legend: {
                display: false
            }
        },
            scales: {
                y: {

                    display: false,
                },
                x:{
                    display:false
                }
            },
        }
      };
      window[myChartName] = new Chart(
        document.getElementById('myChart{{ cryptoName }}'),
        window[configName],
      );

</script>
    {% if cryptoDetails %}
          {% for data in cryptoDetails %}
              <h4> Alias : {{ data.alias }} </h4>
              <h4> Name : {{ data.name }} </h4>
              <h4> Description : {{ data.description }}</h4>
          {% endfor %}
      {% endif %}
    <h4> Current Price : {{ currentPrice }}</h4>
    <h4> Market Capacity : {{ marketCap }}</h4>
    <h4> Circulating Supply : {{ circulatingSupply }}</h4>
    </form>

    <form method="POST" action="{% url 'crypto:makepayment'%}?cryptoName={{ cryptoName }} ">
        {% csrf_token %}
        <input name="MakeTransaction" type="submit" value="Make A Transaction">
    </form>
{% include 'footer.html' %}
</body>
</html>